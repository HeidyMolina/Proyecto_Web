<% /* views/requisitos.ejs */ %>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
  body {
    background-image: url('/images/fondo_verde.png');
    background-size: cover;
    background-repeat: no-repeat;
    background-attachment: fixed;
    font-family: Arial, sans-serif;
    color: #1b2e1f;
  }

  .requisito-box {
    background-color: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    box-shadow: 0 0 15px rgba(0,0,0,0.15);
  }

.beneficios-section h2 {
  color: #fff !important; /* Blanco puro */
  text-shadow: 1px 1px 3px rgba(0,0,0,0.5); /* opcional para resaltar */
}

  .requisito-icon {
    flex-shrink: 0;
    width: 60px;
    height: 60px;
    border: 3px solid #4caf50;
    border-radius: 50%;
    overflow: hidden;
    margin-right: 20px;
    background-color: #fff;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .requisito-icon img {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 50%;
  }

  .requisito-text {
    font-size: 1.1rem;
    font-weight: bold;
    flex: 1;
  }

  .container-requisitos {
    max-width: 900px;
    margin: 60px auto;
  }

 .titulo-seccion {
  text-align: center;
  margin-bottom: 40px;
  color: #1b5e20;
  font-size: 2.5rem;
  font-weight: 700;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.2), 0 0 10px rgba(255,255,255,0.5);
  letter-spacing: 1px;
}


  .seccion {
    background-color: rgba(255, 255, 255, 0.95);
    border-radius: 15px;
    padding: 25px;
    margin: 40px auto;
    max-width: 900px;
    box-shadow: 0 0 15px rgba(0,0,0,0.15);
  }

  .item {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    font-weight: 500;
    font-size: 1.05rem;
  }

  .item i {
    font-size: 1.4rem;
    margin-right: 10px;
    color: #4caf50;
  }

  .testimonio {
    gap: 20px;
    margin-bottom: 25px;
  }

  .testimonio img {
    width: 70px;
    height: 70px;
    object-fit: cover;
    border-radius: 50%;
    border: 2px solid #4caf50;
  }

  .cta {
    background-color: #6dbf3f;
    color: white;
    font-weight: bold;
    padding: 12px 30px;
    border-radius: 30px;
    text-decoration: none;
    box-shadow: 0 5px 10px rgba(0,0,0,0.2);
    transition: background-color 0.3s ease;
  }

  .cta:hover {
    background-color: #4caf50;
  }

  .form-check-input {
    transform: scale(1.4);
    margin-right: 15px;
  }

  .progress {
    height: 30px;
  }

  .progress-bar {
    font-weight: bold;
    font-size: 1rem;
  }

.testimonio-card {
  background: linear-gradient(135deg, #0a6e9c, #4f7cff); /* celeste a azul */
  border-radius: 20px;
  padding: 30px;
  text-align: center;
  box-shadow: 0 0 15px rgba(4, 12, 29, 0.89);
  transition: all 0.4s ease-in-out;
  height: 100%;
  color: #0a0000;
  position: relative;
  overflow: hidden;
}

.testimonio-card:hover {
  background: linear-gradient(135deg, #03232e, #005bea); /* celeste fuerte → azul fuerte */
  color: #f1f1f1;
  box-shadow: 0 0 35px 12px rgba(0, 140, 255, 0.6); /* brillo azul celeste */
  transform: scale(1.04);
}


.testimonio-card:hover .grado {
  color: #f0eaf0;
}

.testimonio-card:hover .nombre {
  color: #180a69;
}

.testimonio-card:hover .cita {
  color: #e1dbeb;
}


.testimonio-card img {
  width: 150px;
  height: 150px;
  object-fit: cover;
  border-radius: 50%;
  margin-bottom: 12px;
  box-shadow: 0 0 8px rgba(0,0,0,0.1);
}

.nombre {
  font-weight: bold;
  font-size: 1.4rem;
  margin-bottom: 5px;
  color: #02000a;
}

.grado {
  font-style: italic;
  color: #180757;
  margin-bottom: 10px;
}

.cita {
  font-size: 0.95rem;
  color: #030008;
  margin-bottom: 10px;
}



</style>

<div class="container container-requisitos animate__animated animate__fadeIn">
 <h2 class="titulo-seccion animate__animated animate__fadeInDown">
  <i class="bi bi-check2-circle me-2"></i>Requisitos para causar alta como tropa
</h2>

<p class="text-center fs-5 fw-semibold text-success mb-4 animate__animated animate__fadeInDown">
  Coloca un <strong>check</strong> en los requisitos que ya cumples y observa tu progreso.
</p>

<!-- Barra de progreso -->
<div class="progress mb-4">
  <div id="barraProgreso" class="progress-bar progress-bar-striped progress-bar-animated bg-primary"
       role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
    0%
  </div>
</div>

<style>
  .imagen-flotante {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    max-width: 300px;
    z-index: 9999;
    animation: flotar 2s infinite alternate ease-in-out;
  }

  @keyframes flotar {
    0% { transform: translate(-50%, -50%) scale(1); }
    100% { transform: translate(-50%, -52%) scale(1.05); }
  }
</style>
<!-- Imagen flotante de victoria con fondo oscuro -->
<div id="imagenCheck" class="overlay-victoria" style="display: none;">
  <img src="/images/check1.png" alt="¡Completado!" class="imagen-check-centrada animate__animated animate__zoomIn">
</div>


<!-- Canvas para confeti -->
<canvas id="confettiCanvas" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:9999; display:none;"></canvas>



  <% if (Array.isArray(requisitos) && requisitos.length > 0) { %>
  <div class="row">
    <% requisitos.forEach((req, index) => { %>
      <div class="col-12 col-md-6">
        <div class="requisito-box">
          <input type="checkbox" class="form-check-input requisito-check" data-index="<%= index %>">
          <div class="requisito-icon">
            <% if (req.imagen && req.imagen.trim() !== '') { %>
              <img src="<%= req.imagen %>" alt="Icono">
            <% } else { %>
              <img src="/images/default_icon.png" alt="Icono por defecto">
            <% } %>
          </div>
          <div class="requisito-text">
            <%- req.texto %>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
<% } else { %>
  <p class="text-center text-muted">No hay requisitos disponibles en este momento.</p>
<% } %>
</div>

<!-- Beneficios -->
<!-- ¿Que beneficios te ofrecemos?-->
<section class="beneficios-section py-5">
  <div class="container efecto-verde text-center p-4 rounded-4">
   <h2 class="mb-4 text-success fw-bold display-5 animate__animated animate__fadeInUp">
  <i class="bi bi-stars me-2"></i>¿Qué beneficios obtienes?<i class="bi bi-stars me-2"></i>
</h2>

    <div class="row justify-content-center g-4">
      <% beneficios.forEach(ben => { %>
        <div class="col-12 col-sm-6 col-md-6 col-lg-4"> <!-- Aumentamos el ancho de columna -->
          <div class="beneficio-card-publico p-4 shadow-sm h-100 d-flex flex-column align-items-center justify-content-between">
            <img src="<%= ben.imagen %>" alt="Icono" class="img-beneficio mb-3">
            <p class="texto-beneficio m-0"><%= ben.texto %></p>
          </div>
        </div>
      <% }) %>
    </div>
  </div>
</section>

<style>
  .efecto-verde {
    background: linear-gradient(135deg, rgba(42, 6, 170, 0.74), rgba(58, 10, 230, 0.8));
    backdrop-filter: blur(3px);
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.15);
  }

  .beneficio-card-publico {
    background-color: rgba(173, 216, 230, 0.9);
    border-radius: 25px;
    transition: transform 0.3s ease-in-out;
    padding: 20px;
  }

  .beneficio-card-publico:hover {
    transform: scale(1.03);
    box-shadow: 0 0 20px rgba(19, 51, 139, 0.884);
  }

  .img-beneficio {
    width: 300px;
    height: 250px;
    object-fit: cover;
    border-radius: 20px;
    border: 4px solid #3e3cbf;
    background-color: #fff;
    box-shadow: 0 0 15px rgba(0, 0, 0, 0.25);
    transition: transform 0.3s ease;
  }

  .img-beneficio:hover {
    transform: scale(1.1);
  }

  .texto-beneficio {
    font-weight: bold;
    color: #000000;
    font-size: 1.1rem;
    margin-top: 10px;
  }

  h2.text-primary {
  color: #003366 !important; /* azul fuerte */
  text-shadow: 1px 1px 4px rgba(0,0,0,0.2); /* opcional, para resaltar */
}

</style>



<!-- Testimonios -->
<section class="container mt-5 animate__animated animate__fadeInUp">
  <h2 class="text-center mb-4 fw-bold display-6 text-primary animate__animated animate__fadeIn">
 </i>¿Qué piensa el personal de alta?
</h2>
<p class="text-center text-dark fs-4 fw-semibold mb-4 animate__animated animate__fadeInUp">
  Descubre cómo prestar servicio militar ha impactado positivamente en sus vidas
</p>


  <% if (testimonios.length === 0) { %>
    <p class="text-center text-muted">No hay testimonios registrados aún.</p>
  <% } else { %>
    <div class="row g-4">
      <% testimonios.forEach(testimonio => { %>
        <div class="col-md-4">
         <div class="testimonio-card">
            <img src="<%= testimonio.imagen %>" alt="Foto" class="mb-3">
            <div class="nombre"><%= testimonio.nombre %></div>
            <div class="grado"><%= testimonio.grado %></div>
            <div class="cita">"<%= testimonio.cita %>"</div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
</section>

<!-- Llamado a la Acción -->
<div class="text-center mt-5">
<p class="text-center text-dark fs-4 fw-semibold mb-4 animate__animated animate__fadeInUp">
  ¡Sirve a tu nación y transforma tu vida con disciplina, honor y valor!
</p>

</div>


<!-- Panel de contacto institucional -->
<footer class="footer-contacto w-100 mt-5 py-4">
  <div class="d-flex flex-wrap justify-content-center gap-3 align-items-center w-100 px-4">
    
    <a href="https://www.google.com/maps?q=14.545572,-91.558504" target="_blank" class="contacto-btn">
      <i class="bi bi-geo-alt-fill me-2"></i>Dirección: km 167, Carretera al Pacífico, Cuyotenango, Suchitepéquez, Guatemala.
    </a>

    <span class="contacto-btn" style="cursor: default;">
  <i class="bi bi-telephone-fill me-2"></i>Teléfono: 3999 5720
</span>

    <a href="https://mail.google.com/mail/?view=cm&fs=1&to=cuartabrigadajrbarrios@gmail.com" 
   target="_blank" class="contacto-btn">
  <i class="bi bi-envelope-fill me-2"></i>Correo: cuartabrigadajrbarrios@gmail.com
</a>


    <a href="https://www.facebook.com/CuartabrigadaGJRB" target="_blank" class="contacto-btn">
      <i class="bi bi-facebook me-2"></i>Facebook
    </a>

  </div>
</footer>

<style>
/* ===== Footer ===== */
.footer-contacto {
  background: linear-gradient(135deg, #001f3f, #004d99); /* degradado azul oscuro */
  border-top: 4px solid #00c3ff;
  box-shadow: 0 -2px 15px rgba(0, 0, 0, 0.5);
  color: white;
  width: 100vw;
  margin: 0;
  padding: 20px 0;
  text-align: center;
}

/* Botones de contacto */
.contacto-btn {
  background: linear-gradient(135deg, #29f1f1, #2446dd); /* celeste → azul */
  color: #fff !important;
  font-weight: 600;
  font-size: 1rem;
  border-radius: 30px;
  padding: 10px 20px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  transition: all 0.3s ease-in-out;
  box-shadow: 0 4px 12px rgba(0,0,0,.3);
}

.contacto-btn:hover {
  background: linear-gradient(135deg, #2446dd, #29f1f1); /* invierte colores */
  transform: scale(1.08);
  box-shadow: 0 6px 20px rgba(0, 180, 255, 0.6);
}

.contacto-btn i {
  font-size: 1.2rem;
}

/* Responsivo */
@media (max-width: 768px) {
  .contacto-btn {
    width: 100%;
    justify-content: center;
  }
}

/* ===== Animaciones opcionales ===== */
.imagen-flotante {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 300px;
  z-index: 9999;
  animation: flotar 2s infinite alternate ease-in-out;
  pointer-events: none;
}

@keyframes flotar {
  0% { transform: translate(-50%, -50%) scale(1); }
  100% { transform: translate(-50%, -52%) scale(1.05); }
}

.overlay-victoria {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 9998;
}

.imagen-check-centrada {
  max-width: 80vw;
  max-height: 80vh;
  animation: flotarSuave 2s infinite alternate ease-in-out;
}

@keyframes flotarSuave {
  0%   { transform: scale(1); }
  100% { transform: scale(1.05); }
}
</style>



<!-- Script: barra de progreso dinámica -->
<script>
  const checkboxes = document.querySelectorAll('.requisito-check');
  const barra = document.getElementById('barraProgreso');
  const imagenCheck = document.getElementById('imagenCheck');
  const confettiCanvas = document.getElementById('confettiCanvas');
  const ctx = confettiCanvas.getContext("2d");

  let confetiActivo = false;

  function actualizarProgreso() {
    const total = checkboxes.length;
    const marcados = Array.from(checkboxes).filter(chk => chk.checked).length;
    const porcentaje = total === 0 ? 0 : Math.round((marcados / total) * 100);

    barra.style.width = porcentaje + '%';
    barra.setAttribute('aria-valuenow', porcentaje);
    barra.textContent = porcentaje + '%';

    if (porcentaje === 100 && !confetiActivo) {
      imagenCheck.style.display = "flex"; // Cambiado a flex
      lanzarConfeti();
      confetiActivo = true;

      // Ocultar imagen automáticamente después de 5 segundos
      setTimeout(() => {
        imagenCheck.style.display = "none";
        detenerConfeti();
        confetiActivo = false;
      }, 5000);

    } else if (porcentaje < 100) {
      imagenCheck.style.display = "none";
      detenerConfeti();
      confetiActivo = false;
    }
  }

  checkboxes.forEach(chk => {
    chk.addEventListener('change', actualizarProgreso);
  });

  actualizarProgreso();

  // === CONFETI ===
  let confettis = [];

  function crearConfeti() {
    return {
      x: Math.random() * window.innerWidth,
      y: Math.random() * -100,
      r: Math.random() * 6 + 4,
      d: Math.random() * 100,
      color: `hsl(${Math.random() * 360}, 70%, 60%)`,
      tilt: Math.random() * 10 - 5,
      tiltAngle: 0,
      tiltAngleIncrement: Math.random() * 0.07 + 0.05
    };
  }

  function lanzarConfeti() {
    confettiCanvas.style.display = "block";
    confettis = Array.from({length: 150}, crearConfeti);
    requestAnimationFrame(dibujarConfeti);
  }

  function dibujarConfeti() {
    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);

    confettis.forEach(confeti => {
      ctx.beginPath();
      ctx.lineWidth = confeti.r;
      ctx.strokeStyle = confeti.color;
      ctx.moveTo(confeti.x + confeti.tilt + confeti.r / 2, confeti.y);
      ctx.lineTo(confeti.x + confeti.tilt, confeti.y + confeti.tilt + confeti.r);
      ctx.stroke();
    });

    moverConfeti();

    if (confetiActivo) {
      requestAnimationFrame(dibujarConfeti);
    }
  }

  function moverConfeti() {
    confettis.forEach(confeti => {
      confeti.tiltAngle += confeti.tiltAngleIncrement;
      confeti.y += Math.cos(0.01 + confeti.d) + 2;
      confeti.tilt = Math.sin(confeti.tiltAngle) * 15;
    });
  }

  function detenerConfeti() {
    confettiCanvas.style.display = "none";
    ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
  }

  window.addEventListener("resize", () => {
    confettiCanvas.width = window.innerWidth;
    confettiCanvas.height = window.innerHeight;
  });

  confettiCanvas.width = window.innerWidth;
  confettiCanvas.height = window.innerHeight;
</script>

<audio id="audioRequisitos" src="/audio/saliendodesubase.mpeg" loop></audio>
<audio id="audioDisparos" src="/audio/disparos.mp3"></audio> 
<script>
  const audioRequisitos = document.getElementById("audioRequisitos");

  // Función para iniciar el audio
  function iniciarAudio() {
    audioRequisitos.currentTime = 0;
    audioRequisitos.play().catch(err => {
      console.warn("El navegador bloqueó la reproducción automática:", err);

      // Si lo bloquea, mostrar un botón flotante para iniciar
      if (!document.getElementById("btnPlayAudio")) {
        const btn = document.createElement("button");
        btn.id = "btnPlayAudio";
        btn.textContent = "▶ Reproducir Audio";
        Object.assign(btn.style, {
          position: "fixed",
          bottom: "20px",
          right: "20px",
          padding: "12px 20px",
          background: "#2e7d32",
          color: "#fff",
          border: "none",
          borderRadius: "8px",
          cursor: "pointer",
          fontWeight: "bold",
          boxShadow: "0 4px 10px rgba(0,0,0,0.3)",
          zIndex: 9999
        });

        btn.addEventListener("click", () => {
          audioRequisitos.play();
          btn.remove();
        });

        document.body.appendChild(btn);
      }
    });
  }

  // Intentar reproducir al cargar
  window.addEventListener("load", iniciarAudio);

  // Detener al salir
  window.addEventListener("beforeunload", () => {
    audioRequisitos.pause();
    audioRequisitos.currentTime = 0;
  });
</script>
